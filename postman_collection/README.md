## Postman-коллекция для проверки API

Файл `referral_system_collection.postman_collection.json` содержит postman-коллекцию - набор заранее подготовленных запросов для проверки работы API.


## Подготовка к запуску коллекции

1. В активированном виртуальном окружении должны быть установлены все зависимости проекта.
2. Должны быть выполнены миграции.


## Загрузка коллекции в Postman:

1. Запустите Postman.
2. В левом верхнем углу нажмите `File` -> `Import`.
3. Во всплывающем окне будет предложено перетащить в него файл с коллекцией либо выбрать файл через окно файлового менеджера.
Загрузите файл `referral_system_collection.postman_collection.json` в Postman.

## Запуск коллекции:

1. После выполнения предыдущих шагов, в левой части окна Postman во вкладке `Collections` появилась импортированная коллекция.
2. Данный шаг нужно выполнить только при запуске коллекции без локального развертывания.
Зайдите во вкладку `Variables` коллекции и измените переменную baseURL на `https://referral-system-ooml.onrender.com`.
Коллекция сработает правильно только при первом запуске, так как удалить данные из базы данных возможности нет, в отличие от локального развертывания.
3. Наведите на неё курсор, нажмите на три точки напротив названия коллекции и в выпадающем списке выберите `Run collection`. В центре экрана появится список запросов коллекции,
а в правой части экрана - меню для настройки параметров запуска.
4. В правом меню включите функцию `Persist responses for a session` - это даст возможность посмотреть ответы API после запуска коллекции.
5. Нажмите кнопку `Run <название коллекции>`.
6. В центре экрана отобразится результат запуска коллекции и тестов. Провалившиеся тесты можно отфильтровать, перейдя во вкладку `Failed`.
Посмотрите детали выполненного запроса и полученного ответа: для этого нажмите на тест.

## Повторный запуск коллекции:
1. Перейдете в директорию `postman_collection` в корне проекта.
2. При активированном виртуальном окружении проекта, запустите скрипт для очистки базы данных от объектов, созданных при выполнении запросов коллекции: `bash clear_db.sh`.  
При выполнении скрипта будут удалены все пользователи и объекты, созданные при предыдущем запуске коллекции.
